			.def _xcorr
            .align 256          ;align delay buffer 256-byte boundary
            .text		        ;code section

_xcorr:							;A4 = in, x(n); B6 = out, R(k)
  			MV    B4,B0	        ;B4 = samples, N
  			MV	  B4,A0			;A6 = autocorrelation coefficients, k
			ZERO  A1			;zeros k counter
			ZERO  B1			;zeros N counter
			ADD A1,A0,A1		;initialises k counter
			ADD B1,B0,B1		;initialises N counter

corr:							;finds k coefficients
            SUB   A1,1,A1		;decrement k count
sum:					        ;sums N-k autocorrelated products
            MPY     	;
            SUB   B1,1,B1	    ;decrement N count
    [B1]    B     sum    	    ;branch to sum if count != 0
            NOP   5
	[A1]	B	  corr			;branch to corr if count != 0
