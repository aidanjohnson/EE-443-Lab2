			.def _xcorr
            .align 256          ;align delay buffer 256-byte boundary
            .text		        ;code section

_xcorr:							;A4 = in, x(n); B6 = out, R(k)
  			MV    B4,B0	        ;B4 = samples, N
  			MPY   B0,4,B0		;adjusts for 4 Byte float data
  			MV	  B4,A0			;A6 = autocorrelation coefficients, k
			MPY   A0,4,A0		;adjusts for 4 Byte float data
			ZERO  A1			;zeros k counter
			ZERO  B1			;zeros n counter
			ZERO  A9			;zeros accummulator
			ADD   A1,A0,A1		;initialises k counter
			ADD   B1,B0,B1		;initialises n counter
			MV    A4,A5			;n+k pointer

corr:							;finds k coefficients
            ADD   A5,A1,A5      ;shifts n+k pointer by k
            SUB   A1,1,A1		;decrement k count
sum:					        ;sums N-k autocorrelated products
            MPY   A4,A5,A7  	;stores product
            SUM   A9,A7,A9		;adds to accummulator
            ADD   A4,4,
            SUB   B1,1,B1	    ;decrement n count
    [B1]    B     sum    	    ;branch to sum if count != 0
            NOP   5
	[A1]	B	  corr			;branch to corr if count != 0
